<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>How to Spatial Modeling with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">How to Spatial Modeling with R</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>class: inverse, center, bottom</p>
<section id="how-to-spatial-modeling-with-r" class="level1">
<h1>How to Spatial Modeling with R</h1>
<p>.side-text[]</p>
<p>.title-where[ RLadies DC 2022<br> How to Spatial Modeling with R<br> September 21-22, 2022]</p>
<hr>
<p>class: chapter-slide A bit about me</p>
<hr>
<p>.pull-left[ <em>Federica Gazzelloni</em> is an R enthusiast and has been practicing R spatial participating in the #30DayMapChallenge competition on Twitter last year. She is a mentor within the R4DS community learning on slack and recently participated as one of the diversity scholars at the RStudio::conf2022. She is also an author in the health sector and looking to be more involved with investigations. Prior to that, she taught Mathematics at a high school in Rome and provided professional guidance on how to use excel for work at the European University of Tourism. She loves making data visualizations and applying statistical techniques for model forecasting.]</p>
<p>.pull.right[</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fg_picture.png" class="img-fluid figure-img" style="width:40.0%" alt="Statistician and Actuary with International experience"></p>
<p></p><figcaption class="figure-caption">Federica Gazzelloni</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>]</p>
<hr>
<p>class: chapter-slide</p>
</section>
<section id="learning-objectives" class="level1">
<h1>Learning objectives</h1>
<hr>
<section id="at-the-end-you-will-be-able-to" class="level3">
<h3 class="anchored" data-anchor-id="at-the-end-you-will-be-able-to">At the end you will be able to:</h3>
<ul>
<li>Make a map!</li>
</ul>
<p>–</p>
<ul>
<li>Understand spatial data complexity</li>
</ul>
<p>–</p>
<ul>
<li>Make a spatial model visualization</li>
</ul>
<hr>
</section>
<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">Prerequisites</h3>
<p>This ice-breaking activity to spatial modeling with R includes two case studies:</p>
<ul>
<li>Oregon spotted frog habitat study</li>
<li>A type of cancer spread in Scotland</li>
</ul>
<p>To set up install the following packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>my_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>,<span class="st">"purrr"</span>,<span class="st">"ggthemes"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"maptools"</span>,<span class="st">"ggmap"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"spdep"</span>,<span class="st">"sf"</span>,<span class="st">"spocc"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"dismo"</span>,<span class="st">"SpatialEpi"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(my_packages, <span class="at">repos =</span> <span class="st">"http://cran.rstudio.com"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"fgazzelloni/oregonfrogs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The GitHub repository for this workshop is here: https://github.com/Fgazzelloni/How-to-Spatial-Modeling-with-R</p>
</section>
<section id="session-1" class="level3">
<h3 class="anchored" data-anchor-id="session-1">Session 1</h3>
<p>–</p>
<ul>
<li>Introduction</li>
</ul>
<p>–</p>
<ul>
<li>Hands-on mapping of Rana Pretiosa around the US</li>
</ul>
<p>–</p>
<ul>
<li>Making spatial assumptions</li>
</ul>
<p>–</p>
<p><strong>Break and Q&amp;A</strong></p>
<p>–</p>
</section>
<section id="session-2" class="level3">
<h3 class="anchored" data-anchor-id="session-2">Session 2</h3>
<p>–</p>
<ul>
<li>Introduction</li>
</ul>
<p>–</p>
<ul>
<li>Hands-on mapping of a particular form of cancer in Scotland</li>
</ul>
<p>–</p>
<ul>
<li>Making a spatial model</li>
</ul>
<p>–</p>
<p><strong>Break and Q&amp;A</strong></p>
<p>–</p>
</section>
<section id="wrap-up-and-qa" class="level3">
<h3 class="anchored" data-anchor-id="wrap-up-and-qa">Wrap-up and Q&amp;A</h3>
<hr>
<p>class: chapter-slide</p>
</section>
</section>
<section id="session-1-1" class="level1">
<h1>Session 1</h1>
<hr>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>–</p>
<p>Spatial data is most often represented by one of two data models, vector or raster. In geostatistical models, sampled data are interpreted as the result of a random process.</p>
<p>–</p>
<p>Spatial modeling is an important instrument to guide decision-making dealing with risk-management in different areas, such as public health, econometrics, general ecology, as well as public transportation and real-estate.</p>
<p>–</p>
<p>An important distinction has to be made between <strong>spatial model</strong> and <strong>spatial data model</strong>. While <em>data models</em> are important connections between the individual perception of certain events and how those events are being represented and processed with an algorithm, for example as spatial primitives and relationships.</p>
<p>–</p>
<p><em>Spatial models</em> are defined as <em>process models</em>. Dynamic spatial processes are phenomena that change in time, such as a virus spread, flood formation, and land cover change. A heuristic explanation of how point distances are calculated is to considered wheather the Eulerian or the Lagrangian views are the most suitable ones.</p>
<p>–</p>
<blockquote class="blockquote">
<p>“Eulerian models concern about the change of properties (e.g.&nbsp;temperature, land cover) at fixed locations, while Lagrangian models tracks the movement of objects in space.”</p>
</blockquote>
<hr>
<p>As said, one more important distinction is that <strong>Geographic Information Systems (GISs)</strong> are composed of raster and vector data.</p>
<p>–</p>
<blockquote class="blockquote">
<p>In vector data models space is not quantized into discrete grid cells like the raster model, but use points and associated X, Y coordinate pairs to represent the vertices of spatial feature.</p>
</blockquote>
<p>–</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/layers.jpg" class="img-fluid figure-img" style="width:30.0%"></p>
<p></p><figcaption class="figure-caption">Credits: <a href="https://planet.uwc.ac.za/nisl/gis/web_page/page_15.htm">Spatial data models</a></figcaption><p></p>
</figure>
</div>
</div>
</div>
<hr>
<p>Spatial models allows for spatial autocorrelation. In general modeling, multicollinearity, or correlation among predictors in the model is used to make predictors selection. In case of spatial modeling, predictors such as longitude and latitude are evidence of important underlying spatial processes at work; an integral component of the data.</p>
<p>–</p>
<p>So, spatial data is considered typically autocorrelated and/or clustered. A simple explanation is related with the independency of correlated clusters with the changing data-information in the spatial cluster.</p>
<p>–</p>
<p>Hence, data may be spatially correlated and observations in neighboring areas may be more similar than observations in areas that are farther away.</p>
<p>–</p>
<p>The analysis of the residual spatial autocorrelation and the prediction of continuous spatial process is called <strong>Kriging</strong> (or, <strong>geo interpolation</strong> named after Danie Kringe (South Africa), also known as <em>Wiener–Kolmogorov</em> prediction / distance-weighted average).</p>
<p>–</p>
<p>A spatial model is a representation of various social and natural processes:</p>
<ul>
<li>land cover change</li>
<li>spread of invasive species</li>
<li>population migration</li>
</ul>
<hr>
<p>So, to be more explicit, spatial modeling combines spatial analysis and predictions.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/framework.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Credits:https://besjournals.onlinelibrary.wiley.com/doi/10.1111/1365-2656.13116</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>–</p>
<p><strong>Krinking</strong> is even the term that defines the best model performance, and so, the best prediction. This term is considered as synonym of <em>prediction</em> in classical data forecasting model techniques.</p>
<hr>
<p>The integration of <strong>GIS</strong> and <strong>Multicriteria Decision-Making Analysis (MCDA)</strong> is key in providing help to decision makers in different areas. GIS-based MCDA use a linear weighted equation to combine the spatial variables.</p>
<p>–</p>
<p><span class="math display">\[y=\sum_{i=1}^n{w_if(x_i)}\]</span></p>
<p>Where <span class="math inline">\(W\)</span> defines a spatial neighborhood structure over the entire study region, and its elements can be viewed as weights.</p>
<p>Under this structure, the total number of neighbors in each area is adjusted to obtain a standardized matrix:</p>
<p><span class="math display">\[w_\text{std(i,j)}=\frac{w_{ij}}{\sum_{j=1}^{n}{w_{ij}}}\]</span></p>
<p>–</p>
<p>There are a number of spatial models that can be used, for Spatial and Spatio-Temporal Modelling, Prediction and Simulation. One is Kriging, while other methods are the Geographically Weighted Regression (GWR) or Inverse Distance Weighting (IDW).</p>
<hr>
<section id="hands-on" class="level4">
<h4 class="anchored" data-anchor-id="hands-on">Hands-on</h4>
<hr>
<p>class: chapter-slide</p>
</section>
</section>
</section>
<section id="session-2-1" class="level1">
<h1>Session 2</h1>
<hr>
<section id="introduction-1" class="level3">
<h3 class="anchored" data-anchor-id="introduction-1">Introduction</h3>
<p>–</p>
<p>This example is from the {SpatialEpi} package, and it is about Lip cancer in Scotland area.</p>
<p>–</p>
<p>In general, the first metric for disease risk estimation is the incidence, which is a measure of the probability of occurrence of a given medical condition in a population within a specified period of time. More specifically, the risk estimation can be obtained by computing the <strong>Standardized Incidence Ratios (SIRs)</strong>.</p>
<p>–</p>
<p>The ratio of the observed to the expected disease counts: <span class="math display">\[SIRi = \frac{Y_i}{E_i}\]</span></p>
<p>–</p>
<p>( the expected() function of the {SpatialEpi} package )</p>
<hr>
<div class="cell" data-paged.print="false">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SpatialEpi)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"scotland"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(scotland)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "geo"             "data"            "spatial.polygon" "polygon"        </code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<table>
<caption>Scotland Lip cancer data</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> county.names </th>
   <th style="text-align:right;"> cases </th>
   <th style="text-align:right;"> expected </th>
   <th style="text-align:right;"> AFF </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> skye-lochalsh </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 1.4 </td>
   <td style="text-align:right;"> 0.16 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> banff-buchan </td>
   <td style="text-align:right;"> 39 </td>
   <td style="text-align:right;"> 8.7 </td>
   <td style="text-align:right;"> 0.16 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> caithness </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 3.0 </td>
   <td style="text-align:right;"> 0.10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> berwickshire </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 2.5 </td>
   <td style="text-align:right;"> 0.24 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ross-cromarty </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 4.3 </td>
   <td style="text-align:right;"> 0.10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> orkney </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 2.4 </td>
   <td style="text-align:right;"> 0.24 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>–</p>
<p>We can plot the cases versus the expected and visualize them in one plot.</p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">fortify</span>(scotland<span class="sc">$</span>spatial.polygon)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>case_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>scotland<span class="sc">$</span>data,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">map_id =</span> county.names)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_map</span>(<span class="at">map =</span> map,<span class="fu">aes</span>(<span class="at">fill=</span>cases)) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> map<span class="sc">$</span>long, <span class="at">y =</span> map<span class="sc">$</span>lat) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scotland cases"</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_map</span>()<span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>expected_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>scotland<span class="sc">$</span>data,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">map_id =</span> county.names)) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_map</span>(<span class="at">map =</span> map,<span class="fu">aes</span>(<span class="at">fill=</span>expected)) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> map<span class="sc">$</span>long, <span class="at">y =</span> map<span class="sc">$</span>lat) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scotland expected"</span>) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_map</span>() <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>As well as adding some annotations.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>case_map <span class="sc">+</span> expected_map <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Lip Cancer Spatial model -cases vs expected - Scotland"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Source: Scotland dataset in SpatialEpi_data"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="presentation_files/figure-html/ggplot-ex4-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>Model types:</p>
<ul>
<li>LR linear regression</li>
<li>multivariate logistic regression modeling of weights <span class="math inline">\(w_i\)</span> (animal habitat)</li>
<li>discriminant analysis (community resilience to environmental disasters)</li>
<li>support vector machine (SVM)</li>
<li>decision-trees</li>
<li>genetic algorithm (GA)</li>
<li>artificial neural network (ANN) or deep neural network (DNN)</li>
</ul>
<hr>
<p>Model adjustment</p>
<p>Base spatial models are adjusted to data-type based on the type of phenomenon that is investigated. As an example, a virus spread would be best represented with a Poisson distribution, of which a log transformation can be applied.</p>
<p>A list of the <em>tools</em> for making models adjustment is to decide whether to use:</p>
<ul>
<li>CAR</li>
<li>Poisson or spatial effect of the log of the Poisson</li>
<li>Markov chain Monte Carlo (MCMC)</li>
<li>spatial cross validation resampling</li>
<li>deterministic or Bayesian model (Integrated nested Laplace approximation (INLA) is a computational less-intensive alternative to MCMC designed to perform approximate Bayesian inference in latent Gaussian models)</li>
</ul>
<hr>
<p>Finally, <strong>validation</strong> is an important step in <em>spatial modeling work</em>. A model can be validated by testing its prediction in another dataset or study area that is different from the dataset or study area where the model was trained, allowing for spatial correlation and spatially correlated risk factors.</p>
<hr>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>This is the end of our tutorial on how to spatial modeling with R.</p>
<p>The most interesting part of this overall introduction is how to manage different packages dealing with both raster and vector data. We now know how to deal with different type of data for making a map, and are aware of the model adjustments that are required for making a spatial model. Important to mention are the weights and the distances, these two factors are very important for influencing the results of a model predictor.</p>
<p>Good luck with your maps! I look forward to seeing your future Twitter posts for the next #30DayMapChallenge edition 2022 which starts on the first of October with the release of the topics for each of the 30 days challenge of November.</p>
<hr>
<p>class: chapter-slide</p>
</section>
</section>
<section id="wrap-up-and-qa-1" class="level1">
<h1>Wrap up and Q&amp;A</h1>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>